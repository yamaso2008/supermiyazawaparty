<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUPER MIYAZAWA PARTY</title>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Lilita+One&display=swap" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(to bottom, #6dd5ed, #2193b0);
            color: #ffffff;
            font-family: 'Lilita One', cursive;
            text-align: center;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        h1 {
            font-family: 'Bangers', cursive;
            color: #ffde26;
            font-size: 4rem;
            text-shadow: 
                -4px -4px 0 #e67e22, 4px -4px 0 #e67e22, -4px 4px 0 #e67e22, 4px 4px 0 #e67e22, 6px 6px 0 #454545;
            margin: 1rem 0;
            letter-spacing: 5px;
        }

        #number-display {
            font-size: 15rem;
            font-weight: bold;
            color: #ffffff;
            -webkit-text-stroke: 5px #272727;
            text-stroke: 10px #121212;
            margin-bottom: 2rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            50% { transform: translateY(-15px); }
        }

        #instruction {
            font-size: 1.8rem;
            text-shadow: 3px 3px 0 #000000;
            height: 2rem;
        }

        .roulette-active {
            animation: spin 0.1s infinite alternate;
        }
        @keyframes spin {
            100% { transform: translateY(-5px) rotate(3deg); }
        }

        /* --- ボタンエリア --- */
        #next-player-button {
            font-family: 'Lilita One', cursive;
            font-size: 1.5rem;
            color: #ffffff;
            background-color: #e74c3c;
            border: 4px solid #ffffff;
            border-radius: 15px;
            padding: 10px 30px;
            cursor: pointer;
            transition: all 0.1s ease-in-out;
            box-shadow: 0 8px 0 #c0392b;
            position: fixed;
            bottom: 30px;
            z-index: 10;
        }
        #next-player-button:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #c0392b;
        }
        
        /* --- ログ表示リンク --- */
        #log-toggle-link {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
            text-decoration: underline;
            text-shadow: 2px 2px 0 #000000;
            z-index: 10;
        }
        
        /* --- ログモーダル --- */
        #log-modal {
            display: none; /* 初期状態では非表示 */
            position: fixed;
            z-index: 20;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            justify-content: center;
            align-items: center;
        }
        #log-modal-content {
            background: linear-gradient(to bottom, #4a4a4a, #2c2c2c);
            margin: auto;
            padding: 20px;
            border: 5px solid #ffde26;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }
        #log-list-container {
            overflow-y: auto;
        }
        #log-list {
            list-style: none;
            padding: 0;
            text-align: left;
        }
        .log-entry {
            font-size: 1.2rem;
            margin-bottom: 10px;
            padding: 8px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.5);
        }
        .log-separator {
            text-align: center;
            color: #ffde26;
            font-weight: bold;
        }
        #close-log-button {
            font-family: 'Lilita One', cursive;
            font-size: 1.5rem;
            color: #ffffff;
            background-color: #2980b9;
            border: 4px solid #ffffff;
            border-radius: 15px;
            padding: 10px 30px;
            cursor: pointer;
            box-shadow: 0 6px 0 #2471a3;
            transition: all 0.1s ease-in-out;
            align-self: center;
            margin-top: 20px;
        }
        #close-log-button:active {
             transform: translateY(4px);
             box-shadow: 0 3px 0 #2471a3;
        }
    </style>
</head>
<body>

    <div id="log-toggle-link">ログ表示</div>

    <h1>SUPER MIYAZAWA PARTY</h1>
    <div id="number-display">?</div>
    <p id="instruction">スペースキーを押してルーレット！</p>
    
    <button id="next-player-button">次のプレイヤー</button>

    <div id="log-modal">
        <div id="log-modal-content">
            <h2>ログ</h2>
            <div id="log-list-container">
                <ul id="log-list"></ul>
            </div>
            <button id="close-log-button">閉じる</button>
        </div>
    </div>

    <audio id="roulette-sound" src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjQwLjEwMQAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAW5vrja7Z5r4sAnw0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7A8AAn9+ce0gAIAAAAASW5mbwAAAA8AAAAFAAAEABERPj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4..."></audio>
    <audio id="decision-sound" src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjQwLjEwMQAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEluZm8AAAAPAAAADAAABAAA19/p9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn9395n9yZ/+KAn98cQAgAAGb/////8K1a3Vtv7y1b2/pmpW1bW29ub///8v/pmpW//pmpW9vby//+ZqVv/+ZqVvby1tb//5mpW1tbW1vby//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbW//+ZqVtbW1tbf/9bW29vby1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbf/+AAAD/7Rso//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tGyn/+0bK//7Rsr//tG..."></audio>

    <script>
        // --- DOM要素の取得 ---
        const numberDisplay = document.getElementById('number-display');
        const instruction = document.getElementById('instruction');
        const nextPlayerButton = document.getElementById('next-player-button');
        const logToggleLink = document.getElementById('log-toggle-link');
        const logModal = document.getElementById('log-modal');
        const closeLogButton = document.getElementById('close-log-button');
        const logList = document.getElementById('log-list');
        const rouletteSound = document.getElementById('roulette-sound');
        const decisionSound = document.getElementById('decision-sound');
        
        // --- 変数定義 ---
        let availableNumbers = [];
        let logs = [];
        let rouletteInterval;
        let isSpinning = false;
        
        // --- データ管理 (LocalStorage) ---
        const AVAILABLE_NUMBERS_KEY = 'superMiyazawaParty_availableNumbers_v2';
        const LOGS_KEY = 'superMiyazawaParty_logs_v2';

        function saveData() {
            localStorage.setItem(AVAILABLE_NUMBERS_KEY, JSON.stringify(availableNumbers));
            localStorage.setItem(LOGS_KEY, JSON.stringify(logs));
        }

        function loadData() {
            const savedNumbers = localStorage.getItem(AVAILABLE_NUMBERS_KEY);
            const savedLogs = localStorage.getItem(LOGS_KEY);

            if (savedNumbers) {
                availableNumbers = JSON.parse(savedNumbers);
            } else {
                initializeNumbers();
            }

            if (savedLogs) {
                logs = JSON.parse(savedLogs);
            }
        }

        // --- 初期化 ---
        function initializeNumbers() {
            availableNumbers = Array.from({ length: 34 }, (_, i) => i + 1);
        }

        // --- ログ機能 ---
        function addLog(logData) {
            const now = new Date();
            const timestamp = now.toLocaleString('ja-JP');
            
            const logEntryData = { 
                timestamp: `[${timestamp}]`, 
                type: logData.type,
                value: logData.value
            };
            logs.unshift(logEntryData);
            saveData();
        }

        function renderLogs() {
            logList.innerHTML = '';
            if (logs.length === 0) {
                logList.innerHTML = '<li class="log-entry">ログはまだありません。</li>';
                return;
            }
            logs.forEach(log => {
                const li = document.createElement('li');
                li.classList.add('log-entry');

                if (log.type === 'separator') {
                    li.textContent = log.value;
                    li.classList.add('log-separator');
                } else {
                    li.textContent = `${log.timestamp} 数字: ${log.value}`;
                }
                logList.appendChild(li);
            });
        }

        // --- ルーレット機能 ---
        function startRoulette() {
            if (isSpinning) return;
            isSpinning = true;

            if (availableNumbers.length === 0) {
                instruction.textContent = 'すべての数字が出ました！';
                isSpinning = false;
                return;
            }
            
            instruction.style.display = 'none';
            rouletteSound.play();
            rouletteInterval = setInterval(() => {
                const randIndex = Math.floor(Math.random() * availableNumbers.length);
                numberDisplay.textContent = availableNumbers[randIndex];
            }, 50);
            numberDisplay.classList.add('roulette-active');
            setTimeout(stopRoulette, 1000);
        }

        function stopRoulette() {
            clearInterval(rouletteInterval);
            rouletteSound.pause();
            rouletteSound.currentTime = 0;
            decisionSound.play();

            const randIndex = Math.floor(Math.random() * availableNumbers.length);
            const chosenNumber = availableNumbers.splice(randIndex, 1)[0];

            numberDisplay.textContent = chosenNumber;
            numberDisplay.classList.remove('roulette-active');
            
            numberDisplay.style.transform = 'scale(1.1)';
            setTimeout(() => { numberDisplay.style.transform = 'scale(1)'; }, 100);
            
            addLog({ type: 'number', value: chosenNumber });
            isSpinning = false;
        }

        // --- イベントリスナー ---
        nextPlayerButton.addEventListener('click', () => {
            // ログに区切り線を追加
            if (numberDisplay.textContent !== '?') {
                 addLog({ type: 'separator', value: '--- 次のプレイヤー ---' });
            }
            
            // 数字プールのみリセット
            initializeNumbers();
            saveData(); // リセットされた数字プールを保存
            
            numberDisplay.textContent = '?';
            instruction.textContent = 'スペースキーを押してルーレット！';
            instruction.style.display = 'block';
            isSpinning = false;
        });

        logToggleLink.addEventListener('click', () => {
            renderLogs();
            logModal.style.display = 'flex';
        });

        closeLogButton.addEventListener('click', () => {
            logModal.style.display = 'none';
        });

        window.addEventListener('click', (event) => {
            if (event.target == logModal) {
                logModal.style.display = 'none';
            }
        });
        
        document.body.onkeyup = (e) => {
            if (e.code === 'Space') {
                startRoulette();
            }
        };

        // --- 起動処理 ---
        loadData();
    </script>
</body>
</html>
